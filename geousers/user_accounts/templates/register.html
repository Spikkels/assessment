



{% extends 'base.html' %}

{% load static %}
{% load leaflet_tags %}

{% block content %}
  <h1>Register</h1>
  <form method="post">
    {% csrf_token %}
    <div>
      <label for="username">Username:</label>
      <input type="text" id="username" name="username">
    </div>
    <div>
      <label for="email">Email:</label>
      <input type="email" id="email" name="email">
    </div>
    <div>
      <label for="password1">Password:</label>
      <input type="password" id="password1" name="password1">
    </div>
    <div>
      <label for="password2">Password confirmation:</label>
      <input type="password" id="password2" name="password2">
    </div>
    <div>
      <label for="home_address">Home address:</label>
      <input type="text" id="home_address" name="home_address">
    </div>
    <div>
      <label for="phone_number">Phone number:</label>
      <input type="text" id="phone_number" name="phone_number">
    </div>
    <div>
      <label for="location">Location:</label>
      <input type="hidden" id="location" name="location">
    </div>
    <input type="submit" value="Register">
  </form>

  <div id="map" style="width: 100%; height: 400px;"></div>

  <script src="{% static 'leaflet/leaflet.js' %}"></script>
  <link rel="stylesheet" href="{% static 'leaflet/leaflet.css' %}">

  <script>
    var map = L.map('map').setView([51.505, -0.09], 13);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; OpenStreetMap contributors'
    }).addTo(map);

    var marker;

    function onMapClick(e) {
      if (marker) {
        map.removeLayer(marker);
      }
      marker = L.marker(e.latlng).addTo(map);
      document.getElementById("location").value = "POINT(" + e.latlng.lng + " " + e.latlng.lat + ")";
    }

    map.on('click', onMapClick);
  </script>
{% endblock %}
